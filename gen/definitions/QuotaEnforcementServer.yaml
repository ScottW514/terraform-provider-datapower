name: QuotaEnforcementServer
description: '<p>On each DataPower Gateway, you configure the quota enforcement server
  to store the thresholds and associated metadata in memory or persist them on the
  RAID volume.</p><p>The quota enforcement server can work in standalone mode or peer
  group mode.</p><p>A peer group is collection of at least three nodes across which
  quota enforcement is implemented. In each peer group, one DataPower Gateway is the
  primary node and others are replicas. Failover might occur when the primary node
  becomes unavailable.</p><p>When you enable the peer group mode, the appropriate
  configuration properties are displayed. You must configure the connection among
  peers.</p><p>Based on your requirements for quota enforcement, you can enable or
  disable strict mode. Strict mode affects data-consistency across the peer group.</p><p>When
  strict mode is enabled, the following effects are caused: <ul><li>When the primary
  node is operational and when strict mode of all nodes in a peer group is enabled,
  threshold synchronization is more frequent to ensure data-consistency across the
  peer group. However, more network bandwidth is used. Therefore, strict mode is suitable
  for peers in the same data center.</li><li>When the primary node becomes unavailable,
  before failover occurs, the replica with enabled strict mode cannot process the
  request. <p>If service performance and availability are more important than data-consistency,
  you can disable strict mode for the replica so that this replica can process the
  request. The replica with disabled strict mode writes the threshold and associated
  metadata to the local data storage. After failover occurs, the connection is resumed
  between the replica and the new primary node. The threshold and associated metadata
  stored by the replica might be overwritten by the new primary node when the new
  primay node synchronizes the data to all replicas. Data-consistency might be affected
  across the peer group.</p></li></ul></p><p>By default, data is stored in memory
  and quota enforcement server works in standalone mode.</p>'
cli_alias: quota-enforcement-server
cmd_group: system
rest_endpoint: /mgmt/config/default/QuotaEnforcementServer/QuotaEnforcementServer
update_only: true
default_domain_only: true
attributes:
- name: mAdminState
  tf_name: enabled
  type: Bool
  bool_type: admin
  default: true
  description: <p>The administrative state of the configuration.</p><ul><li>To make
    active, set to enabled.</li><li>To make inactive, set to disabled.</li></ul>
  cli_alias: admin-state
- name: UserSummary
  type: String
  description: Specifies a brief descriptive summary for the configuration.
  cli_alias: summary
- name: PasswordAlias
  type: String
  reference_to: PasswordAlias
  description: Specifies the password alias to secure the data store. If not specified,
    a system default is used.
  cli_alias: password-alias
- name: RaidVolume
  type: String
  reference_to: RaidVolume
  description: <p>Specifies whether data storage is persistent or in-memory. <ul><li>For
    persistent storage, select the RAID volume that must be <tt>raid0</tt> .</li><li>For
    in-memory storage, do not select the RAID volume.</li></ul></p>
  cli_alias: raid-volume
- name: ServerPort
  type: Int64
  required: true
  default: 16379
  description: Indicates the listening port used by the GatewayScript module to communicate
    with the quota enforcement server. The default port value is 16379.
  cli_alias: server-port
- name: MonitorPort
  type: Int64
  required: true
  default: 26379
  description: Indicates the listening port for operational state monitoring for the
    quota enforcement server. The default port is 26379.
  cli_alias: monitor-port
- name: EnablePeerGroup
  type: Bool
  default: false
  description: Indicates whether the DataPower Gateway is enabled to work in peer
    group mode. By default, peer group mode is disabled, which indicates that the
    DataPower Gateway works in standalone mode.
  cli_alias: enable-peer-group
- name: EnableSSL
  type: Bool
  default: true
  description: Indicates whether TLS is used to secure connection among the peers
    of the peer group. By default, the TLS is enabled.
  cli_alias: enable-ssl
  ignored_when:
  - evaluation: property-equals
    attribute: EnablePeerGroup
    value:
    - 'off'
- name: SSLCryptoKey
  type: String
  reference_to: CryptoKey
  description: Indicates the key alias for the DataPower Gateway to authenticate a
    peer of the DataPower Gateway during the TLS handshake.
  cli_alias: ssl-key
  required_when:
  - evaluation: logical-and
    conditions:
    - evaluation: property-equals
      attribute: EnablePeerGroup
      value:
      - 'on'
    - evaluation: property-equals
      attribute: EnableSSL
      value:
      - 'on'
  ignored_when:
  - evaluation: logical-or
    conditions:
    - evaluation: property-equals
      attribute: EnablePeerGroup
      value:
      - 'off'
    - evaluation: property-equals
      attribute: EnableSSL
      value:
      - 'off'
- name: SSLCryptoCertificate
  type: String
  reference_to: CryptoCertificate
  description: Indicates the certificate alias that is sent to a peer when the DataPower
    Gateway negotiates a TLS connection with the peer.
  cli_alias: ssl-cert
  required_when:
  - evaluation: logical-and
    conditions:
    - evaluation: property-equals
      attribute: EnablePeerGroup
      value:
      - 'on'
    - evaluation: property-equals
      attribute: EnableSSL
      value:
      - 'on'
  ignored_when:
  - evaluation: logical-or
    conditions:
    - evaluation: property-equals
      attribute: EnablePeerGroup
      value:
      - 'off'
    - evaluation: property-equals
      attribute: EnableSSL
      value:
      - 'off'
- name: IPAddress
  type: String
  description: <p>Indicates the IP address of the DataPower Gateway for other peers
    to connect to. The IP address can be the IP address on any interface of the DataPower
    Gateway and must be accessible by other peers in the peer group. The IP address
    cannot be 127.0.0.1, 0.0.0.0 or ::. This IP address uniquely identifies the DataPower
    Gateway.</p><p>You can use a local host alias instead of a static IP address.
    A host alias resolves a locally configured alias to a static IP address.</p>
  cli_alias: ip-address
  required_when:
  - evaluation: property-equals
    attribute: EnablePeerGroup
    value:
    - 'on'
  ignored_when:
  - evaluation: property-equals
    attribute: EnablePeerGroup
    value:
    - 'off'
  string_exclude:
  - 127.0.0.1
  - 0.0.0.0
  - '::'
  - '::1'
- name: Peers
  type: List
  element_type: String
  description: '<p>Specifies peers of the DataPower Gateway in the peer group. The
    DataPower Gateway connects to each peer in the order in which peers are added
    in the list. It is not necessary to specify all peers in the Peers list.</p><ul><li>When
    the DataPower Gateway connects to no peer in the list, this DataPower Gateway
    is the first active server and joins the peer group as the primary node.</li><li>When
    the DataPower Gateway connects to any peer in the list, it joins the peer group
    as a replica.</li></ul><p>You can use a local host alias instead of a static IP
    address. A host alias resolves a locally configured alias to a static IP address.
    Aliasing can help when you move configurations among appliances.</p><p>Note: Do
    not specify the IP address or hostname of this DataPower Gateway.</p>'
  cli_alias: peer
  ignored_when:
  - evaluation: property-equals
    attribute: EnablePeerGroup
    value:
    - 'off'
  string_exclude:
  - 127.0.0.1
  - 0.0.0.0
  - '::'
  - '::1'
- name: Priority
  type: Int64
  maximum: 255
  default: 100
  description: <p>Indicates the priority that is used to decide which replica is promoted
    to the primary node when failover occurs.</p><p>Enter a value in range 0 - 255.
    The default value is 100. The replica with the lowest priority number is promoted.
    A replica with the value of 0 can never be promoted.</p>
  cli_alias: priority
  required_when:
  - evaluation: property-equals
    attribute: EnablePeerGroup
    value:
    - 'on'
  ignored_when:
  - evaluation: property-equals
    attribute: EnablePeerGroup
    value:
    - 'off'
- name: StrictMode
  type: Bool
  default: true
  description: Based on your requirements for quota enforcement, enable or disable
    strict mode. By default, the strict mode is enabled.
  cli_alias: strict-mode
  ignored_when:
  - evaluation: property-equals
    attribute: EnablePeerGroup
    value:
    - 'off'
