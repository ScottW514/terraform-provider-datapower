---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "datapower_api_gateway Resource - terraform-provider-datapower"
subcategory: ""
description: |-
  An API gateway matches the API to process API requests and to route each request to the matched API.
  CLI Alias: apigwAccepted Dependency Actions: flush_stylesheet_cache, flush_document_cache
---

# datapower_api_gateway (Resource)

An API gateway matches the API to process API requests and to route each request to the matched API.
  - CLI Alias: `apigw`
  - Accepted Dependency Actions: `flush_stylesheet_cache`, `flush_document_cache`

## Example Usage

```terraform
resource "datapower_api_gateway" "test" {
  id                       = "ResTestAPIGateway"
  app_domain               = "acceptance_test"
  front_protocol           = ["AccTest_HTTPSourceProtocolHandler"]
  front_timeout            = 120
  front_persistent_timeout = 180
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `app_domain` (String) The name of the application domain the object belongs to
- `front_protocol` (List of String) Protocol handler (reference to HTTP or HTTPS Source Protocol Hander)
  - CLI Alias: `front-protocol`
- `id` (String) Name of the object. Must be unique among object types in application domain.

### Optional

- `api_collection` (List of String) Specify the API collections to serve a group of clients. Each collection packages the plans and subscribers to serve a specific group of clients.
  - CLI Alias: `collection`
  - Reference to: `datapower_api_collection:id`
- `assembly_burst_limit` (Attributes List) - CLI Alias: `assembly-burst-limit` (see [below for nested schema](#nestedatt--assembly_burst_limit))
- `assembly_count_limit` (Attributes List) Assembly count limits
  - CLI Alias: `assembly-count-limit` (see [below for nested schema](#nestedatt--assembly_count_limit))
- `assembly_rate_limit` (Attributes List) Assembly rate limits
  - CLI Alias: `assembly-rate-limit` (see [below for nested schema](#nestedatt--assembly_rate_limit))
- `cache_memory_size` (Number) Specify the maximum size of the stylesheet cache. The default value is 2147483647. A value of 0 disables caching. Stylesheets are purged when either the cache size or the cache count is reached.
  - CLI Alias: `xsl-cache-memorysize`
  - Default value: `2147483647`
- `cache_size` (Number) Specify the maximum number of stylesheets to cache. Enter a value in the range 5 - 250000. The default value is 256. Stylesheets are purged when either the cache size or the cache count is reached.
  - CLI Alias: `xsl-cache-size`
  - Range: `5`-`250000`
  - Default value: `256`
- `dependency_actions` (Attributes List) Actions to take on other resources when operations are performed on this resource. (see [below for nested schema](#nestedatt--dependency_actions))
- `doc_cache_max_docs` (Number) Specify the maximum number of documents to cache. Enter a value in the range 1 - 250000. The default value is 5000.
  - CLI Alias: `maxdocs`
  - Range: `1`-`250000`
  - Default value: `5000`
- `doc_cache_policy` (Attributes List) Specify the document cache policies to associate a set of URLs with a specific cache policy. A document cache policy allows the administrator to determine how documents are cached. The policy offers time-to-live, priority, and type. The document cache is distinct from the stylesheet cache.
  - CLI Alias: `policy` (see [below for nested schema](#nestedatt--doc_cache_policy))
- `doc_cache_size` (Number) Specify the maximum size of the document cache. Regardless of the specified size, no document that is greater than 1073741824 bytes is cached. This restriction applies even if the cache has available space.
  - CLI Alias: `size`
- `doc_max_writes` (Number) Specify the maximum number of concurrent write requests to create documents or refresh expired documents in the document cache. Enter a value in the range 1 - 32768. The default value is 32768. After the maximum number is reached, requests are forwarded to the target server and the response is not written to the cache.
  - CLI Alias: `max-writes`
  - Range: `1`-`32768`
  - Default value: `32768`
- `front_persistent_timeout` (Number) Specify the inter-transaction timeout for client connections. This value is the maximum idle time to allow between the completion of a transaction and the initiation of a new transaction for a client connection. If the specified idle time is exceeded, the connection is torn down. Enter a value in the range 0 - 86400. The default value is 180. A value of 0 disables persistent connections.
  - CLI Alias: `front-persistent-timeout`
  - Range: `0`-`86400`
  - Default value: `180`
- `front_timeout` (Number) Specify the intra-transaction timeout for client connections. This value is the maximum idle time to allow in a transaction for a client connection. This timer monitors idle time in the data transfer process. If the specified idle time is exceeded, the connection is torn down. Enter a value in the range 1 - 86400. The default value is 120.
  - CLI Alias: `front-timeout`
  - Range: `1`-`86400`
  - Default value: `120`
- `gateway_service_name` (String) Gateway service name
  - CLI Alias: `gateway-service-name`
- `ldap_conn_pool` (String) LDAP connection pool
  - CLI Alias: `ldap-pool`
  - Reference to: `datapower_ldap_connection_pool:id`
- `open_telemetry` (String) OpenTelemetry instance
  - CLI Alias: `otel`
  - Reference to: `datapower_open_telemetry:id`
- `open_telemetry_resource_attribute` (Attributes List) OpenTelemetry resource attributes
  - CLI Alias: `otel-resource-attribute` (see [below for nested schema](#nestedatt--open_telemetry_resource_attribute))
- `proxy_policies` (Attributes List) Specify the proxy policies to associate a set of URLs with a specific HTTP proxy. When multiple proxy policies are defined, URLs are evaluated against each policy in order.
  - CLI Alias: `proxy` (see [below for nested schema](#nestedatt--proxy_policies))
- `scheduled_rule` (Attributes List) Specify the processing rules to run at defined intervals. Certain applications require the running of a processing rule. For example, the integration with a CA Unicenter Manager is facilitated by a regularly scheduled processing rule that obtains relationship data from the Unicenter Manager.
  - CLI Alias: `schedule-rule` (see [below for nested schema](#nestedatt--scheduled_rule))
- `sha1caching` (Boolean) Specify how to manage SHA1-assisted stylesheet caching. With SHA1 caching enabled, stylesheets are cached by both URL and SHA1 message digest value. With SHA1 caching disabled, stylesheets are cached only by URL.
  - CLI Alias: `xsl-checksummed-cache`
  - Default value: `true`
- `share_rate_limit_count` (String) Share rate limit count
  - CLI Alias: `share-count`
  - Choices: `yes`, `no`
  - Default value: `yes`
- `static_document_calls` (Boolean) Specify how to manage static document calls. The latest XSLT specifications require that multiple document calls in the same transformation return the same result. Disable this setting to allow all document calls to operate independently.
  - CLI Alias: `static-document-calls`
  - Default value: `true`
- `url_refresh_policy` (String) Specify the stylesheet refresh policy. Stylesheets cached by this gateway are refreshed in accordance with policy rules.
  - CLI Alias: `xslrefresh`
  - Reference to: `datapower_url_refresh_policy:id`
- `user_summary` (String) Comments
  - CLI Alias: `summary`
- `virtual_servers` (List of String) Load balancer groups
  - CLI Alias: `loadbalancer-group`
  - Reference to: `datapower_load_balancer_group:id`

<a id="nestedatt--assembly_burst_limit"></a>
### Nested Schema for `assembly_burst_limit`

Required:

- `burst` (Number) Indicates the maximum allowed burst rate. The value of 0 indicates no limit. A message is rejected when the burst limit is exceeded.
- `name` (String) Indicates the name of the burst limit scheme.

Optional:

- `cache_only` (Boolean) Specifies whether to use the local cache first to enforce the burst limit. In peer group mode, using the local cache first can prevent transaction delays if communication problems arise across the peer group. However, the transaction count is less precise when this setting is enabled.
  - Default value: `true`
  - Not Valid When: `burst`=`0`
- `dynamic_value` (String) Indicates the dynamic value string for the burst limit, which should contain one or more context variables. The dynamic value makes it possible to use a context variable to enforce the burst limit based on parameters other than those defined in the burst limit scheme, such as a user name, incoming IP address, or server name. The context variable can be set in a GatewayScript action and then included in the dynamic value. <p>The following example uses the context object in a GatewayScript action to add the <tt>my.server</tt> variable to the API context.</p><p><tt>context.set("my.server", "server34")</tt></p><p>The dynamic value can then include the variable <tt>my.server</tt> , which resolves to the server name <tt>server34</tt> .</p><p>The default value is an empty string.</p>
  - Not Valid When: `burst`=`0`
- `interval` (Number) Indicates the time interval for the burst limit. Specify a value that is greater than or equal to 1. The default value is 1.
  - Range: `1`-`65535`
  - Default value: `1`
  - Not Valid When: `burst`=`0`
- `is_client` (Boolean) Indicates whether to apply the burst limit to the client or to an internal component. Client burst limits return a 429 error when exceeded. Non-client burst limits return a 503 error when exceeded. When set to <tt>off</tt> , burst limit information is not included in the response header.
  - Default value: `true`
  - Not Valid When: `burst`=`0`
- `unit` (String) Indicates the time unit for the burst limit. The default value is second.
  - Choices: `second`, `minute`
  - Default value: `second`
  - Not Valid When: `burst`=`0`
- `use_api_name` (Boolean) Indicates whether to use the API name as part of the burst limit key.
  - Default value: `false`
  - Not Valid When: `burst`=`0`
- `use_app_id` (Boolean) Indicates whether to use the application ID as part of the burst limit key.
  - Default value: `false`
  - Not Valid When: `burst`=`0`
- `use_client_id` (Boolean) Indicates whether to use the client ID as part of the burst limit key.
  - Default value: `false`
  - Not Valid When: `burst`=`0`
- `weight` (String) Specifies a JSONata expression that assigns a weight value to the transaction. For each API call, the value computed by the weight expression is applied to the burst limit. The default value is 1. If the weight expression evaluates to a value that is less than or equal to 0, it is set to 1. An empty string results in an error.
  - Default value: `1`
  - Not Valid When: `burst`=`0`


<a id="nestedatt--assembly_count_limit"></a>
### Nested Schema for `assembly_count_limit`

Required:

- `count` (Number) Indicates the maximum count that this limit will allow.
- `name` (String) Indicates the name of the count limit scheme.

Optional:

- `auto_dec` (Boolean) Indicates whether to automatically decrement this count limit in each transaction.
  - Default value: `true`
- `cache_only` (Boolean) Specifies whether to use the local cache first to enforce the count limit. In peer group mode, using the local cache first can prevent transaction delays if communication problems arise across the peer group. However, the transaction count is less precise when this setting is enabled.
  - Default value: `true`
- `dynamic_value` (String) Indicates the dynamic value string for the count limit, which should contain one or more context variables. The default value is an empty string.
- `hard_limit` (Boolean) <p>Indicates whether to reject requests when the specified count limit is reached.</p><ul><li>When enabled, the API Gateway rejects requests when the limit is exceeded.</li><li>When disabled, the API Gateway still handles the requests but produces a warning message.</li></ul><p>By default, the API Gateway rejects requests when the limit is exceeded.</p>
  - Default value: `true`
- `is_client` (Boolean) Indicates whether to apply the count limit to the client or to an internal component. Client count limits return a 429 error when exceeded. Non-client count limits return a 503 error when exceeded. When set to <tt>off</tt> , count limit information is not included in the response header.
  - Default value: `false`
- `use_api_name` (Boolean) Indicates whether to use the API name as part of the count limit key.
  - Default value: `false`
- `use_app_id` (Boolean) Indicates whether to use the application ID as part of the count limit key.
  - Default value: `false`
- `use_client_id` (Boolean) Indicates whether to use the client ID as part of the count limit key.
  - Default value: `false`
- `weight` (String) Specifies a JSONata expression that assigns a weight value to the transaction. For each API call, the value computed by the weight expression is applied to the count limit. The default value is 1. If the weight expression evaluates to a value that is less than or equal to 0, it is set to 1. An empty string results in an error.
  - Default value: `1`


<a id="nestedatt--assembly_rate_limit"></a>
### Nested Schema for `assembly_rate_limit`

Required:

- `name` (String) Indicates the name of the rate limit scheme.
- `rate` (Number) Indicates the maximum number of requests that the API Gateway can handle within a time interval. The value of 0 indicates no limit.
  - Range: `0`-`4294967295`

Optional:

- `cache_only` (Boolean) Specifies whether to use the local cache first to enforce the rate limit. In peer group mode, using the local cache first can prevent transaction delays if communication problems arise across the peer group. However, the transaction count is less precise when this setting is enabled.
  - Default value: `true`
  - Not Valid When: `rate`=`0`
- `dynamic_value` (String) Indicates the dynamic value string for the rate limit, which should contain one or more context variables. The dynamic value makes it possible to use a context variable to enforce the rate limit based on parameters other than those defined in the rate limit scheme, such as a user name, incoming IP address, or server name. The context variable can be set in a GatewayScript action and then included in the dynamic value. <p>The following example uses the context object in a GatewayScript action to add the <tt>my.server</tt> variable to the API context.</p><p><tt>context.set("my.server", "server34")</tt></p><p>The dynamic value can then include the variable <tt>my.server</tt> , which resolves to the server name <tt>server34</tt> .</p><p>The default value is an empty string.</p>
  - Not Valid When: `rate`=`0`
- `hard_limit` (Boolean) <p>Indicates whether to reject requests when the specified rate limit is reached.</p><ul><li>When enabled, the API Gateway rejects requests when the limit is exceeded.</li><li>When disabled, the API Gateway still handles the requests but produces a warning message.</li></ul><p>By default, the API Gateway does not reject requests when the limit is exceeded.</p>
  - Default value: `false`
  - Not Valid When: `rate`=`0`
- `interval` (Number) Indicates the time interval for the rate limit. Specify a value that is greater than or equal to 1. The default value is 1.
  - Range: `1`-`65535`
  - Default value: `1`
  - Not Valid When: `rate`=`0`
- `is_client` (Boolean) Indicates whether to apply the rate limit to the client or to an internal component. Client rate limits return a 429 error when exceeded. Non-client rate limits return a 503 error when exceeded. When set to <tt>off</tt> , rate limit information is not included in the response header.
  - Default value: `true`
  - Not Valid When: `rate`=`0`
- `unit` (String) Indicates the time unit for the rate limit. The default value is second.
  - Choices: `second`, `minute`, `hour`, `day`, `week`
  - Default value: `second`
  - Not Valid When: `rate`=`0`
- `use_api_name` (Boolean) Indicates whether to use the API name as part of the rate limit key.
  - Default value: `false`
  - Not Valid When: `rate`=`0`
- `use_app_id` (Boolean) Indicates whether to use the application ID as part of the rate limit key.
  - Default value: `false`
  - Not Valid When: `rate`=`0`
- `use_client_id` (Boolean) Indicates whether to use the client ID as part of the rate limit key.
  - Default value: `false`
  - Not Valid When: `rate`=`0`
- `weight` (String) Specifies a JSONata expression that assigns a weight value to the transaction. For each API call, the value computed by the weight expression is applied to the rate limit. The default value is 1. If the weight expression evaluates to a value that is less than or equal to 0, it is set to 1. An empty string results in an error.
  - Default value: `1`
  - Not Valid When: `rate`=`0`


<a id="nestedatt--dependency_actions"></a>
### Nested Schema for `dependency_actions`

Required:

- `action` (String) Action to take on target resource
- `target_domain` (String) Application domain of the target for the action
- `target_type` (String) Resource type of the target for the action

Optional:

- `on_create` (Boolean) Execute this action on the target when creating this resource.
- `on_delete` (Boolean) Execute this action on the target when deleting this resource.
- `on_update` (Boolean) Execute this action on the target when updating this resource.
- `target_id` (String) Id of the target for the action (required for all resources except `datapower_domain`)


<a id="nestedatt--doc_cache_policy"></a>
### Nested Schema for `doc_cache_policy`

Optional:

- `cache_backend_responses` (Boolean) Caches responses to requests from back-end servers.
  - CLI Alias: `cache-backend-response`
  - Default value: `false`
  - Not Valid When: `type`=`no-cache`
- `cache_unsafe_response` (Boolean) Caches responses to POST and PUT requests when the cache policy type is set to fixed. The response to these requests is the result of an action on the server that might change its resource state. You might want to cache responses to these requests when you know that the action (for example: HTTP POST) will not change the server state.
  - CLI Alias: `cache-unsafe-response`
  - Default value: `false`
  - Not Valid When: (`type`!=`fixed` OR `rest_invalidation`=`true`)
- `http_cache_validation` (Boolean) When a requested HTTP document results in a cache hit, HTTP cache validation with the origin server is performed.
  - CLI Alias: `http-cache-validation`
  - Default value: `false`
  - Not Valid When: `type`=`no-cache`
- `match` (String) Provide a literal or wildcard expression to define a URL set included in the cache policy. The following wildcard characters are available. <table><tr><td valign="top">asterisk (*)</td><td valign="top">Matches 0 or more occurrences of any character.</td></tr><tr><td valign="top">question mark (?)</td><td valign="top">Matches one occurrence of any single character.</td></tr><tr><td valign="top">brackets ( [ ] )</td><td valign="top">Defines a character or numeric range. For example, <tt>[1-5]</tt> matches 1, 2, 3, 4, or 5, while <tt>xs[dl]</tt> matches xsd or xsl.</td></tr></table>
  - CLI Alias: `match`
- `priority` (Number) <p>Specifies the priority of a document to add to or remove from the cache. The greater the value, the higher its priority. Enter a value in the range 1 - 255. The default value is 128.</p><ul><li>When adding documents, the cache uses the policy with the highest priority. If the document matches multiple policies with the same priority, the cache uses the first matching policy in the alphabetized list.</li><li>When removing documents, the cache removes documents that were added by policies with the lowest priority. If multiple documents have the same priority, the cache removes the document that was least recently accessed.</li></ul><p>When you define multiple policies, the DataPower Gateway retains the policies in an alphabetized list. The DataPower Gateway evaluates candidate documents against each policy. Consequently, the priority of policies is important to ensure that the DataPower Gateway caches candidate documents for the appropriate validity period.</p><ul><li>Use a high priority for policies that you want to cache.</li><li>Use a low priority for generic policies. For example, set the priority to 1 when <tt>*</tt> or <tt>*.xml</tt> is the match pattern.</li></ul>
  - CLI Alias: `priority`
  - Range: `1`-`255`
  - Default value: `128`
- `rest_invalidation` (Boolean) Invalidate document cache on unsafe requests. For example, HTTP GET requests are safe requests that do not change the internal state of the server. When an HTTP POST to the same URL occurs, the cache needs to be invalidated because the internal state of the server might have changed. The next GET request must contact the origin service to update the cache with any changes.
  - CLI Alias: `rest-invalidation`
  - Default value: `false`
  - Not Valid When: (`type`=`no-cache` OR `cache_unsafe_response`=`true`)
- `return_expired` (Boolean) <p>In the following situations, whether to return expired content when a client requests it. <ul><li>The DataPower Gateway cannot establish a connection with the origin server.</li><li>The document cache is getting the newest version from the origin server.</li></ul></p><p>A document might persist in the cache after the document is expired. When enabled, the cached document is returned even though it is potentially stale. A warning header indicates that the document is stale.</p>
  - CLI Alias: `return-expired`
  - Default value: `false`
  - Not Valid When: `type`=`no-cache`
- `ttl` (Number) Sets the validity period in seconds for documents in the cache. TTL applies to only the <tt>Fixed</tt> policy type. Enter a value in the range 5 - 31708800. The default value is 900.
  - CLI Alias: `ttl`
  - Range: `0`-`31708800`
  - Default value: `900`
  - Required When: `type`=`fixed`
  - Not Valid When: `type`=`protocol`|`no-cache`
- `type` (String) Select the cache type. The cache type determines whether to cache documents and the mechanism to use to remove cached entries. The default value is Protocol-Based.
  - CLI Alias: `type`
  - Choices: `protocol`, `no-cache`, `fixed`
  - Default value: `protocol`
- `xc10grid` (String) The eXtreme Scale grid configuration to use for caching documents.
  - CLI Alias: `xc10-grid`
  - Not Valid When: `type`=`no-cache`


<a id="nestedatt--open_telemetry_resource_attribute"></a>
### Nested Schema for `open_telemetry_resource_attribute`

Required:

- `value` (String) Value

Optional:

- `key` (String) Key


<a id="nestedatt--proxy_policies"></a>
### Nested Schema for `proxy_policies`

Required:

- `reg_exp` (String) Specify the shell-style match pattern that defines a URL set. The URL set is assigned to a specific HTTP proxy.

Optional:

- `password` (String) Specify the password alias for authentication.
  - Reference to: `datapower_password_alias:id`
  - Not Valid When: `skip`!=`false`
- `remote_address` (String) Specify the hostname or IP address of an HTTP server. With the remote port, this setting designates the HTTP proxy that services the URL set for the match pattern. When Skip is on, the remote host is not used.
  - Required When: `skip`=`false`
  - Not Valid When: attribute is not conditionally required
- `remote_port` (Number) Specify the port on the HTTP server. With the remote host, this setting designates the HTTP proxy that services the URL set for the match pattern. When Skip is on, the remote port is not used.
  - Range: `1`-`65535`
  - Required When: `skip`=`false`
  - Not Valid When: attribute is not conditionally required
- `skip` (Boolean) Specify how to treat the URL set for the match pattern. When set to on, the URL set is not forwarded to an HTTP proxy, and the remote host and remote port of a proxy are not defined. When set to off, the URL set is forwarded to the HTTP proxy designated by the remote host and remote port.
  - Default value: `false`
- `user_name` (String) Specify the username for authentication.
  - Not Valid When: `skip`!=`false`


<a id="nestedatt--scheduled_rule"></a>
### Nested Schema for `scheduled_rule`

Required:

- `rule` (String) Select the rule to run.
  - Reference to: `datapower_style_policy_rule:id`

Optional:

- `interval` (Number) Specify the interval between invocations in seconds. A value of 0 indicates a single invocation.
