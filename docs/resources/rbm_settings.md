---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "datapower_rbm_settings Resource - terraform-provider-datapower"
subcategory: ""
description: |-
  
---

# datapower_rbm_settings (Resource)

<p>Manage role-based management (RBM) settings: RBM, password policy, and account policy</p><ul><li>RBM consists of the following capabilities: Authenticating users, evaluating the access profile, enforcing access to resources</li><li>The password policy sets the password requirements for local user accounts.</li><li>The account policy sets the lockout behavior and the timeout for CLI sessions.</li></ul>
  - CLI Alias: `rbm`
  - Accepted Dependency Actions: `flush_cache`

## Example Usage

```terraform
resource "datapower_rbm_settings" "test" {
  au_method                   = "local"
  au_cache_allow              = "absolute"
  mc_method                   = "local"
  min_password_length         = 6
  require_mixed_case          = false
  require_digit               = false
  require_non_alpha_numeric   = false
  disallow_username_substring = false
  do_password_aging           = false
  do_password_history         = false
  cli_timeout                 = 0
  max_failed_login            = 0
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `apply_to_cli` (Boolean) Specify whether to enforce the RBM policy on CLI sessions. When authentication uses a TLS certificate from a connection peer, you cannot enforce RBM on CLI sessions unless fallback users are supported.
  - CLI Alias: `apply-cli`
  - Default value: `false`
  - Not Valid When: (`au_method`=`client-ssl` AND `fallback_login`=`disabled`)
- `au_cache_allow` (String) Authentication cache mode
  - CLI Alias: `au-cache-mode`
  - Choices: `absolute`, `disabled`, `maximum`, `minimum`
  - Default value: `absolute`
- `au_cache_ttl` (Number) Specify the expiry for cached authentication decisions. Enter a value in the range 1 - 86400. The default value is 600.
  - CLI Alias: `au-cache-ttl`
  - Range: `1`-`86400`
  - Default value: `600`
  - Not Valid When: `au_cache_allow`=`disabled`
- `au_custom_url` (String) Custom URL
  - CLI Alias: `au-custom-url`
  - Required When: `au_method`=`custom`
  - Not Valid When: attribute is not conditionally required
- `au_force_dn_ldap_order` (Boolean) Specify whether to convert the extracted DN to LDAP format. This property is essential when the extracted DN from a TLS certificate is in X.500 format. This format arranges the RDNs of the DNs from left to right with forward slashes as separators; for example, <tt>C=US/O=My Organization/CN=Fred</tt> . <p>When you retrieve the group name with an LDAP search, the authenticated DN must be in LDAP format. This format arranges the RDNs of the DNs from right to left with commas as separators; for example, <tt>CN=Fred, O=My Organization, C=US</tt> .</p>
  - CLI Alias: `au-force-dn-ldap-order`
  - Default value: `false`
  - Not Valid When: `au_method`!=`client-ssl`
- `au_host` (String) Server host
  - CLI Alias: `au-server-host`
  - Required When: (`au_method`=`ldap` AND `au_ldap_load_balance_group`=``)
  - Not Valid When: attribute is not conditionally required
- `au_info_url` (String) Specify the URL of the XML file for authentication. The XML file can be on the DataPower Gateway or on a remote server. You can use the same XML file to map credentials.
  - CLI Alias: `au-info-url`
  - Required When: `au_method`=`xmlfile`
  - Not Valid When: attribute is not conditionally required
- `au_kerberos_keytab` (String) Kerberos keytab
  - CLI Alias: `au-kerberos-keytab`
  - Reference to: `datapower_crypto_kerberos_keytab:id`
  - Required When: `au_method`=`spnego`
  - Not Valid When: attribute is not conditionally required
- `au_ldap_bind_dn` (String) LDAP bind DN
  - CLI Alias: `au-ldap-bind-dn`
  - Not Valid When: (`au_method`!=`ldap` OR `au_ldap_search_for_dn`=`false`)
- `au_ldap_bind_password_alias` (String) LDAP bind password alias
  - CLI Alias: `au-ldap-bind-password-alias`
  - Reference to: `datapower_password_alias:id`
  - Not Valid When: (`au_method`!=`ldap` OR `au_ldap_search_for_dn`=`false`)
- `au_ldap_load_balance_group` (String) Specify the load balancer group of LDAP servers. This setting overrides the settings for the server host and port.
  - CLI Alias: `loadbalancer-group`
  - Reference to: `datapower_load_balancer_group:id`
  - Not Valid When: (`au_method`!=`ldap` AND `au_method`!=`custom`)
- `au_ldap_prefix` (String) Specify the string to add before the username to form the DN. If this value is <tt>CN=</tt> and the username is <tt>Bob</tt> , the complete DN is <tt>CN=Bob,O=example.com</tt> when the LDAP suffix is <tt>O=example.com</tt> .
  - CLI Alias: `ldap-prefix`
  - Default value: `cn=`
  - Not Valid When: (`au_method`!=`ldap` OR `au_ldap_search_for_dn`=`true`)
- `au_ldap_read_timeout` (Number) Specify the time to wait for a response from the LDAP server before the DataPower Gateway closes the LDAP connection. Enter a value in the range 0 - 86400. The default value is 60. A value of 0 indicates that the connection never times out.
  - CLI Alias: `au-ldap-readtimeout`
  - Range: `0`-`86400`
  - Default value: `60`
  - Not Valid When: `au_method`!=`ldap`
- `au_ldap_search_for_dn` (Boolean) Specify whether to retrieve the user DN with an LDAP search. <ul><li>When enabled, the login name presented by the user is used with the LDAP search parameters for an LDAP search to retrieve the user DN.</li><li>When disabled, the login name presented by the user is used with the LDAP prefix and suffix to construct the user DN.</li></ul>
  - CLI Alias: `au-ldap-search`
  - Default value: `false`
  - Not Valid When: `au_method`!=`ldap`
- `au_ldap_search_parameters` (String) LDAP search parameters
  - CLI Alias: `au-ldap-parameters`
  - Reference to: `datapower_ldap_search_parameters:id`
  - Required When: (`au_method`=`ldap` AND `au_ldap_search_for_dn`=`true`)
  - Not Valid When: (`au_method`!=`ldap` OR `au_ldap_search_for_dn`=`false`)
- `au_method` (String) Authentication method
  - CLI Alias: `au-method`
  - Choices: `local`, `xmlfile`, `ldap`, `radius`, `spnego`, `zosnss`, `custom`, `client-ssl`, `oidc`
  - Default value: `local`
- `au_oidc_client_id` (String) Client ID
  - CLI Alias: `au-oidc-client-id`
- `au_oidc_client_secret` (String) Client secret
  - CLI Alias: `au-oidc-client-secret`
  - Reference to: `datapower_password_alias:id`
- `au_oidc_identity_service_url` (String) Identity service URL
  - CLI Alias: `au-oidc-identity-service-url`
- `au_oidc_identity_service_url_ssl_client` (String) TLS client profile
  - CLI Alias: `au-oidc-identity-service-ssl-client`
  - Reference to: `datapower_ssl_client_profile:id`
- `au_oidc_key_fetch_interval` (Number) Retrieval interval for public keys.
  - CLI Alias: `au-oidc-key-fetch-interval`
  - Range: `1`-`86400`
  - Default value: `30`
- `au_oidc_scope` (String) Scope
  - CLI Alias: `au-oidc-scope`
  - Default value: `openid`
- `au_port` (Number) Server port
  - CLI Alias: `au-server-port`
  - Required When: (`au_method`=`ldap` AND `au_ldap_load_balance_group`=``)
  - Not Valid When: attribute is not conditionally required
- `au_ssl_valcred` (String) Validation credentials
  - CLI Alias: `au-valcred`
  - Reference to: `datapower_crypto_val_cred:id`
  - Required When: `au_method`=`client-ssl`
  - Not Valid When: attribute is not conditionally required
- `au_zos_nss_config` (String) z/OS NSS client
  - CLI Alias: `zos-nss-au`
  - Reference to: `datapower_zos_nss_client:id`
  - Required When: `au_method`=`zosnss`
  - Not Valid When: attribute is not conditionally required
- `ca_pub_key_file` (String) Specify the certificate authority (CA) public key file in the <tt>cert:</tt> directory for SSH authentication with SSH user certificates. This public key file contains the public key for one or more certificate authorities.
  - CLI Alias: `ssh-ca-pubkey-file`
  - Required When: `ssh_au_method`=`certificate`
  - Not Valid When: `ssh_au_method`!=`certificate`
- `cli_timeout` (Number) Specify the time after which to invalidate idle CLI sessions. When invalidated, requires re-authentication. Enter a value in the range 0 - 65535. A value of 0 disables the timer. The default value depends on common criteria mode. <ul><li>When common criteria is enabled, the default value is 900.</li><li>When common criteria is not enabled, the default value is 0.</li></ul>
  - CLI Alias: `cli-timeout`
  - Range: `0`-`65535`
  - Default value: `0`
- `dependency_actions` (Attributes List) Actions to take on other resources when operations are performed on this resource. (see [below for nested schema](#nestedatt--dependency_actions))
- `disallow_username_substring` (Boolean) Disallow username substring
  - CLI Alias: `pwd-username`
  - Default value: `false`
- `do_password_aging` (Boolean) Enable aging
  - CLI Alias: `pwd-aging`
  - Default value: `false`
- `do_password_history` (Boolean) Control reuse
  - CLI Alias: `pwd-history`
  - Default value: `false`
- `enabled` (Boolean) <p>The administrative state of the configuration.</p><ul><li>To make active, set to enabled.</li><li>To make inactive, set to disabled.</li></ul>
  - CLI Alias: `admin-state`
  - Default value: `true`
- `fallback_login` (String) Specify whether to use local user accounts as fallback users if remote authentication fails. With fallback users, local user accounts can log on to the DataPower Gateway if authentication fails or during a network outage that affects primary authentication. The recommendation is to restrict fallback users to a subset of local user accounts. <p><b>Note: </b>When authentication uses a TLS certificate from a connection peer, you cannot enforce RBM on CLI sessions unless fallback users are supported.</p>
  - CLI Alias: `fallback-login`
  - Choices: `disabled`, `local`, `restricted`
  - Default value: `disabled`
  - Not Valid When: `au_method`=`local`
- `fallback_user` (List of String) Fallback users
  - CLI Alias: `fallback-user`
  - Reference to: `datapower_user:id`
  - Required When: (NOT`au_method`=`local` AND `fallback_login`=`restricted`)
  - Not Valid When: attribute is not conditionally required
- `ldap_ssl_client_config_type` (String) TLS client type
  - CLI Alias: `ssl-client-type`
  - Choices: `client`
  - Default value: `client`
  - Not Valid When: `au_method`!=`ldap`
- `ldap_ssl_client_profile` (String) TLS client profile
  - CLI Alias: `ssl-client`
  - Reference to: `datapower_ssl_client_profile:id`
  - Not Valid When: (`au_method`!=`ldap` OR `ldap_ssl_client_config_type`!=`client`)
- `ldap_suffix` (String) Specify the string to add after the username to form the DN. If this value is <tt>O=example.com</tt> and the username is <tt>Bob</tt> , the complete DN is <tt>CN=Bob,O=example.com</tt> when the LDAP prefix is <tt>CN=</tt> .
  - CLI Alias: `ldap-suffix`
  - Not Valid When: (`au_method`!=`ldap` OR `au_ldap_search_for_dn`=`true`)
- `ldap_version` (String) LDAP version
  - CLI Alias: `ldap-version`
  - Choices: `v2`, `v3`
  - Not Valid When: `au_method`!=`ldap`
- `lockout_period` (Number) Specify the duration to lock out local user accounts after the maximum number of failed login attempts is exceeded. Instead of locking out accounts for a specific duration, the account can be locked out until re-enabled by a privileged user. Enter a value in the range 0 - 1000, where 0 locks out accounts until reset. The default value depends on common criteria mode. <ul><li>When common criteria is enabled, the default value is 0.</li><li>When common criteria is not enabled, the default value is 1.</li></ul><p><b>Note:</b> The duration applies to all local accounts, including the <tt>admin</tt> user account. The only difference is that the <tt>admin</tt> user account cannot be locked out until reset. When the duration is 0, the <tt>admin</tt> user account is locked out for 120 minutes or until re-enabled by a privileged user.</p>
  - CLI Alias: `lockout-duration`
  - Range: `0`-`1000`
  - Default value: `1`
- `max_failed_login` (Number) Specify the number of failed login attempts to allow before account lockout. Enter a value in the range of 0 - 64, where 0 disables account lockout. The default value depends on common criteria mode. <ul><li>When common criteria is enabled, the default value is 3.</li><li>When common criteria is not enabled, the default value is 0.</li></ul>
  - CLI Alias: `max-login-failure`
  - Range: `0`-`64`
  - Default value: `0`
- `max_password_age` (Number) Specify the expiry for passwords. The default value depends on common criteria mode. <ul><li>When common criteria is enabled, the default value is 90.</li><li>When common criteria is not enabled, the default value is 30.</li></ul>
  - CLI Alias: `pwd-max-age`
  - Range: `1`-`65535`
  - Default value: `30`
  - Required When: `do_password_aging`=`true`
  - Not Valid When: attribute is not conditionally required
- `mc_custom_url` (String) Custom URL
  - CLI Alias: `mc-custom-url`
  - Required When: `mc_method`=`custom`
  - Not Valid When: attribute is not conditionally required
- `mc_force_dn_ldap_order` (Boolean) Specify whether to convert the extracted DN to LDAP format. This property is essential when the extracted DN from a TLS certificate is in X.500 format. This format arranges the RDNs of the DNs from left to right with forward slashes as separators; for example, <tt>C=US/O=My Organization/CN=Fred</tt> . <p>When you retrieve the group name with an LDAP search, the authenticated DN must be in LDAP format. This format arranges the RDNs of the DNs from right to left with commas as separators; for example, <tt>CN=Fred, O=My Organization, C=US</tt> .</p>
  - CLI Alias: `mc-force-dn-ldap-order`
  - Default value: `false`
  - Not Valid When: (`au_method`!=`client-ssl` OR `mc_ldap_search_for_group`!=`true` OR `mc_method`=`custom`)
- `mc_host` (String) Server host
  - CLI Alias: `mc-server-host`
  - Required When: (`mc_ldap_search_for_group`=`true` AND `mc_method`!=`custom`)
  - Not Valid When: attribute is not conditionally required
- `mc_info_url` (String) Specify the URL of the XML file to map credentials. The XML file can be on the DataPower Gateway or on a remote server. You can use the same XML file for authentication.
  - CLI Alias: `mc-info-url`
  - Required When: `mc_method`=`xmlfile`
  - Not Valid When: attribute is not conditionally required
- `mc_ldap_bind_dn` (String) LDAP bind DN
  - CLI Alias: `mc-ldap-bind-dn`
  - Not Valid When: (`mc_ldap_search_for_group`!=`true` OR `mc_method`=`custom`)
- `mc_ldap_bind_password_alias` (String) LDAP bind password alias
  - CLI Alias: `mc-ldap-bind-password-alias`
  - Reference to: `datapower_password_alias:id`
  - Not Valid When: (`mc_ldap_search_for_group`!=`true` OR `mc_method`=`custom`)
- `mc_ldap_load_balance_group` (String) Load balancer group
  - CLI Alias: `mc-loadbalancer-group`
  - Reference to: `datapower_load_balancer_group:id`
  - Not Valid When: (`mc_ldap_search_for_group`!=`true` OR `mc_method`=`custom`)
- `mc_ldap_read_timeout` (Number) Specify the time to wait for a response from the LDAP server before the DataPower Gateway closes the LDAP connection. Enter a value in the range 0 - 86400. The default value is 60. A value of 0 indicates that the connection never times out.
  - CLI Alias: `mc-ldap-readtimeout`
  - Range: `0`-`86400`
  - Default value: `60`
  - Not Valid When: (`mc_ldap_search_for_group`!=`true` OR `mc_method`=`custom`)
- `mc_ldap_search_for_group` (Boolean) Specify whether to search LDAP to retrieve all user groups that match the query. <ul><li>When enabled, the authenticated DN of the user and the LDAP search parameters are used as part of the LDAP search to retrieve all user groups that match the query. When a user belongs to multiple groups, the resultant access policy for this user is additive not most restrictive.</li><li>When disabled, the authenticated identity of the user (DN or user group of local user) is used directly as the input credential.</li></ul>
  - CLI Alias: `mc-ldap-search`
  - Default value: `false`
  - Not Valid When: `mc_method`=`custom`
- `mc_ldap_search_parameters` (String) LDAP search parameters
  - CLI Alias: `mc-ldap-parameters`
  - Reference to: `datapower_ldap_search_parameters:id`
  - Required When: (`mc_ldap_search_for_group`=`true` AND `mc_method`!=`custom`)
  - Not Valid When: attribute is not conditionally required
- `mc_ldap_ssl_client_config_type` (String) TLS client type
  - CLI Alias: `mc-ssl-client-type`
  - Choices: `client`
  - Default value: `client`
  - Not Valid When: (`mc_ldap_search_for_group`!=`true` OR `mc_method`=`custom`)
- `mc_ldap_ssl_client_profile` (String) TLS client profile
  - CLI Alias: `mc-ssl-client`
  - Reference to: `datapower_ssl_client_profile:id`
  - Not Valid When: (`mc_ldap_search_for_group`!=`true` OR `mc_method`=`custom` OR `mc_ldap_ssl_client_config_type`!=`client`)
- `mc_method` (String) Credential-mapping method
  - CLI Alias: `mc-method`
  - Choices: `local`, `xmlfile`, `custom`
  - Default value: `local`
- `mc_port` (Number) Server port
  - CLI Alias: `mc-server-port`
  - Required When: (`mc_ldap_search_for_group`=`true` AND `mc_method`!=`custom`)
  - Not Valid When: attribute is not conditionally required
- `min_password_length` (Number) Specify the minimum length of a valid password. Enter a value in the range 1 - 128. The default value depends on common criteria mode. <ul><li>When common criteria is enabled, the default value is 14.</li><li>When common criteria is not enabled, the default value is 6.</li></ul>
  - CLI Alias: `pwd-minimum-length`
  - Range: `1`-`128`
  - Default value: `6`
- `num_old_passwords` (Number) Specify the number of recent passwords to track to prevent reuse. The default value depends on common criteria mode. <ul><li>When common criteria is enabled, the default value is 3.</li><li>When common criteria is not enabled, the default value is 5.</li></ul>
  - CLI Alias: `pwd-max-history`
  - Range: `1`-`65535`
  - Default value: `5`
  - Required When: `do_password_history`=`true`
  - Not Valid When: attribute is not conditionally required
- `password_hash_algorithm` (String) Specify the algorithm to apply to passwords before they are stored. The hash algorithm affects firmware downgrade and cryptographic modes in the following ways. <ul><li>For firmware downgrade, sha256crypt is not supported in releases earlier than 6.0.1.0.</li><li>For cryptographic modes, like FIPS 140-2 Level 1, md5crypt is not supported in FIPS mode.</li></ul>
  - CLI Alias: `password-hash-algorithm`
  - Choices: `md5crypt`, `sha256crypt`
  - Default value: `md5crypt`
- `require_digit` (Boolean) Require number
  - CLI Alias: `pwd-digit`
  - Default value: `false`
- `require_mixed_case` (Boolean) Require mixed case
  - CLI Alias: `pwd-mixed-case`
  - Default value: `false`
- `require_non_alpha_numeric` (Boolean) Require non-alphanumeric
  - CLI Alias: `pwd-nonalphanumeric`
  - Default value: `false`
- `restrict_admin_to_serial_port` (Boolean) Restrict admin to serial
  - CLI Alias: `restrict-admin`
  - Default value: `false`
- `revoked_keys` (List of String) Specify the OpenSSH public keys to revoke for SSH authentication. Each entry is the public key file in the <tt>cert:</tt> or <tt>sharedcert:</tt> directory and must be in the OpenSSH public key format. These keys are signed by the CA user public key file.
  - CLI Alias: `ssh-revoked-keys`
  - Not Valid When: `ssh_au_method`!=`certificate`
- `ssh_au_method` (Attributes) Specify the method to authenticate SSH users. <ul><li>When no method, the user is prompted for both username and password.</li><li>When password, the user is prompted for the password. For this method, the username must be part of the invocation. With the ssh command, the invocation is in the ssh username@host format.</li><li>When user certificate, the user is not prompted for input. The connection is successful when the invocation provides a signed SSH user certificate that is verified by the CA public key file in the <tt>cert:</tt> directory. With the ssh command, the invocation must include the -i file parameter.</li><li>When both certificate and password, processing attempts to first authenticate with the provided signed SSH user certificate. If unsuccessful, prompts for the password.</li><li>Supported RBM authentication methods with SSH authentication method are local and LDAP. <ul><li>Local authentication method extracts the certificate identity and attempts login with local User of that name.</li><li>LDAP authentication method constructs the DN through LDAP search or by applying the configured prefix and suffix. Since SSH authentication completes prior to the Authentication step no LDAP bind or authenticate will take place.</li></ul></li></ul>
  - CLI Alias: `ssh-au-method` (see [below for nested schema](#nestedatt--ssh_au_method))
- `user_summary` (String) Comments
  - CLI Alias: `summary`

<a id="nestedatt--dependency_actions"></a>
### Nested Schema for `dependency_actions`

Required:

- `action` (String) Action to take on target resource
- `target_domain` (String) Application domain of the target for the action
- `target_type` (String) Resource type of the target for the action

Optional:

- `on_create` (Boolean) Execute this action on the target when creating this resource.
- `on_delete` (Boolean) Execute this action on the target when deleting this resource.
- `on_update` (Boolean) Execute this action on the target when updating this resource.
- `target_id` (String) Id of the target for the action (required for all resources except `datapower_domain`)


<a id="nestedatt--ssh_au_method"></a>
### Nested Schema for `ssh_au_method`

Optional:

- `certificate` (Boolean) CA-signed user certificate
  - Default value: `false`
- `password` (Boolean) Password
  - Default value: `false`
